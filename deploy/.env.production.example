# ==============================
# cliproxy-access-manager (prod)
# ==============================
# Copy to .env and fill required values.
#
# Required values:
# - CLIPROXY_MGMT_BASE_URL
# - CLIPROXY_MGMT_KEY
# - APIM_HTTP_AUTH_TOKEN
#
# Telegram is optional. Keep TELEGRAM_BOT_TOKEN empty to disable bot.

# Upstream cliproxy management endpoint
CLIPROXY_MGMT_BASE_URL=http://127.0.0.1:8317
CLIPROXY_MGMT_KEY=CHANGE_ME_CLIPROXY_MANAGEMENT_KEY

# Image used by docker-compose.deploy.yml
APIM_IMAGE=moocher4097/cliproxy-access-manager:latest

# Sidecar HTTP API bind
APIM_HTTP_ADDR=0.0.0.0:8390

# Protect sidecar HTTP API (required in production)
APIM_HTTP_AUTH_TOKEN=CHANGE_ME_LONG_RANDOM_TOKEN

# Persistence
APIM_DATA_DIR=/data
APIM_DB_PATH=/data/apim.db

# Sync intervals
APIM_KEY_SYNC_INTERVAL=30s
APIM_USAGE_SYNC_INTERVAL=2m
APIM_RECOVERY_CHECK_INTERVAL=60s

# Main project update tracking/control
# Daily check time in UTC (HH:MM). 04:00 means 04:00 UTC daily.
APIM_UPDATE_CHECK_ENABLED=true
APIM_UPDATE_CHECK_TIME=04:00
# Current CLIProxyAPI version is read automatically from management response headers (X-CPA-VERSION).
# Management endpoint for latest version query.
APIM_MANAGEMENT_LATEST_VERSION_URL=/v0/management/latest-version
# Update apply strategy:
# - If APIM_UPDATE_APPLY_COMMAND is empty, sidecar will auto-run docker compose update.
# - Auto mode defaults service name to "cliproxy".
# - Auto mode searches compose file in APIM_AUTO_UPDATE_WORKING_DIR, current dir, parent dir, and /opt/cliproxy.
# - If your compose path/service is non-standard, set APIM_AUTO_UPDATE_COMPOSE_FILE and APIM_AUTO_UPDATE_SERVICE.
APIM_UPDATE_APPLY_COMMAND=
APIM_AUTO_UPDATE_ENABLED=true
APIM_AUTO_UPDATE_SERVICE=cliproxy
APIM_AUTO_UPDATE_COMPOSE_FILE=
APIM_AUTO_UPDATE_WORKING_DIR=

# TLS behavior for cliproxy management endpoint
APIM_INSECURE_SKIP_TLS_VERIFY=false

# Optional log level (reserved)
APIM_LOG_LEVEL=info

# Telegram bot (optional)
TELEGRAM_BOT_TOKEN=
TELEGRAM_ALLOWED_CHAT_IDS=
TELEGRAM_ALLOWED_USER_IDS=
TELEGRAM_POLL_INTERVAL=3s

# Runtime proxy (optional)
HTTP_PROXY=
HTTPS_PROXY=
ALL_PROXY=
NO_PROXY=127.0.0.1,localhost,host.docker.internal

# Build-time Go module proxy (optional)
GOLANG_PROXY=https://proxy.golang.org,direct
